
# 1. VIP 획득과 HA 구성

+ NGINX 인그레스 컨트롤러는 Virtual IP(VIP)를 노드 간 공유하는 기능을 가지고 있지 않는다.

+ 퍼블릭 클라우드 환경에서는 인그레스와 VIP를 연결하는 기능이 있어 그대로 사용하면 되지만, 온프레미스 환경에서는 인그레스에 VIP를 설정하기 위한 작업이 필요하다.





+ kube-keepalived-vip 파드는 VRRP(Virtaul Router Redundancy Protocol)에 따라 멤버의 존재를 확인하고 멤버 중 한 노드에게 VIP를 부여한다.

+ 이 VIP를 받은 노드가 요청을 받아서 인그레스 컨트롤러에 전달한다.

+ 그림에서와 같이 인그레스 컨트롤러가 동작하는 노드와 VIP를 가지는 노드가 같을 필요는 없다.

+ 노드가 달라도 파드 네트워크를 통해 요청은 전달되며 만약 VIP를 가지는 노드가 오프라인이 되면 남은 노드가 VIP를 이어받는다.